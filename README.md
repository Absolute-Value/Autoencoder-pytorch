# 全畳み込みAutoencoderをPytorchで実装したものです

# ファイルとフォルダの説明

## modules/
* *ae.py*
    * 私の作ったオートエンコーダのネットワークです
* *funcs.py*
    * 早期終了のプログラムです。
* *initializer.py*
    * 初期化のプログラムです。
* *loader.py*
    * データ読み込むプログラムです。
* *logger.py*
    * ログ出力のプログラムです。

## data/
* データが入るフォルダで、実行すると自動生成されます

## result/
結果を出力するフォルダで、実行すると自動生成されます  
*other/* 内に結果が入っています

以下、出力内部詳細
* *train.csv*
    * 学習時のパラメータとLossが保存されています
* *train.log*
    * 学習時のログ出力です
* *test.csv*
    * テスト時のパラメータとAUCが保存されています
* *test.log*
    * テスト時のログ出力です
* *model.pt*
    * モデルが保存されています
* *loss.png*
    * Lossのグラフです
* *hist.png*
    * 異常値のヒストグラムです
* *Roc.png*
    * ROC曲線です
* *pic/*
    * 学習時のTrain, Validation入出力画像が入っています
* *ad/*
    * 異常検知結果の入出力画像が入っています

## train.py
オートエンコーダの学習のプログラムです。

## test.py
オートエンコーダのテスト（異常検知）のプログラムです

# 使用方法
1. *data/other/wrench/* 内に画像データを配置してください
    * 詳細はフォルダの説明*data/* をご覧ください

 1. 学習は *python train.py* で開始します
     * 後ろに *--img_size (Ex. 512)* を入れることで画像サイズを指定できます
     * 後ろに *--dim (Ex. 128)* を入れることでボトルネックの次元数を指定できます
     * 後ろに *--lr (Ex. 0.0001)* を入れることでボトルネックの次元数を指定できます
 2. 学習は  
 *python test.py --save_dir (Ex. result/other/wrench256_seed999_20210720_022746)*  
 ()には学習時に生成されたフォルダを入力して開始します
